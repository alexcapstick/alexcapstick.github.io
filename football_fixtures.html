<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Alex Capstick</title>

    <!-- Bootstrap core CSS -->
    <link href="css/bootstrap.css" rel="stylesheet">

    <!-- Custom CSS for the 'One Page Wonder' Template -->
    <link href="css/one-page-wonder.css" rel="stylesheet">

    <style>
        :root {
            --title-text-color: #ffffff;
            --title-text-background-color: #19c116;
            --title-background-color: #0a880e;
            --little-title-text-color: #19c116;
            --main-text-color: #002147;
            --nav-bar-color: #19c116;
            --nav-bar-brand-text-color: #19c116;
            --nav-bar-brand-text-background-color: #ffffff;
            --nav-bar-text-color: #ffffff;
            --nav-bar-text-color-hover: #0a880e;
            --small-background-color: #19c116;
            --link-text-color: #00A5F6;
            --font-family-titles: Sora;
            --font-family-text: Arial;
            --background-color: #ffffff;
            --text-font-size: 18px;
        }



        [data-theme="dark"] {
            --title-text-color: #ffffff;
            --title-text-background-color: #0a880e;
            --title-background-color: #19c116;
            --little-title-text-color: #19c116;
            --main-text-color: #ffffff;
            --nav-bar-color: #222222;
            --nav-bar-brand-text-color: #ffffff;
            --nav-bar-brand-text-background-color: #0a880e;
            --nav-bar-text-color: #ffffff;
            --nav-bar-text-color-hover: #19c116;
            --small-background-color: #19c116;
            --link-text-color: #8FBEFF;
            --font-family-titles: Sora;
            --font-family-text: Arial;
            --background-color: #333333;
            --text-font-size: 18px;
        }

        .fixtures_list {
            list-style-type: none;
            padding: 0;
            margin: 0;
            justify-content: center;
        }

        .date_item {
            font-weight: bold;
            text-align: center;
            padding: 0;
            margin: 0;
            list-style-position: inside;
            list-style: none;
            font-size: 1.5em;
            padding-bottom: 2em;
        }

        .time_list {
            list-style-type: none;
            padding: 0;
            margin: 0;
            justify-content: center;
        }

        .time_item {
            font-weight: bold;
            text-align: center;
            padding: 0;
            margin: 0;
            margin: 0;
            font-size: 1.25em;
            padding-bottom: 1em;
        }

        .game_list {
            display: flex;
            flex-wrap: wrap;
            list-style-type: none;
            padding: 0;
            margin: 0;
            justify-content: center;
        }

        .fixture_item {
            margin-left: 0.5em;
            margin-right: 0.5em;
            padding: 5px;
            margin-bottom: 1em;
            border-radius: 5px;
            background-color: var(--small-background-color);
            color: white;
            font-weight: normal;
        }

        .premier-league {
            background-color: rgb(58, 19, 78);
        }

        .fa-womens-super-league {
            background-color: rgb(235, 85, 77);
        }

        .fa-womens-super-league-cup {
            background-color: rgb(234, 164, 57);
        }

        .bundesliga {
            background-color: rgb(163, 53, 48);
        }

        .efl-cup {
            background-color: rgb(216, 57, 49);
        }

        .fa-cup {
            background-color: rgb(159, 40, 49);
        }

        .champions-league {
            background-color: rgb(28, 45, 85);
        }

        .uefa-europa-league {
            background-color: rgb(27, 61, 127);
        }

        .world-cup {
            background-color: rgb(126, 34, 57);
        }
    </style>


</head>

<body>

    <nav class="navbar navbar-fixed-top navbar-inverse" role="navigation">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="#">AC</a>
                <div class="theme-button-phone">
                    <label class="theme-switch">
                        <input type="checkbox" id="checkbox1" />
                        <div class="slider round"></div>
                    </label>
                </div>

            </div>

            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse navbar-ex1-collapse">
                <ul class="nav navbar-nav">
                    <li><a href="#fixtures">Fixtures</a></li>
                </ul>
                <div class="theme-button-computer">
                    <label class="theme-switch">
                        <input type="checkbox" id="checkbox2" />
                        <div class="slider round"></div>
                    </label>
                </div>
            </div><!-- /.navbar-collapse -->
        </div><!-- /.container -->

    </nav>

    <div class="header-image">

        <div class="headline" id="top_page">
            <div class="container">
                <h1>Football Fixtures</h1>
            </div>
        </div>

    </div><!-- /header-image -->

    <div class="container">

        <!-- START THE FEATURETTES -->

        <hr class="featurette-divider" id="fixtures">
        <div class="featurette">

            <ul id="fixtures_list" class="fixtures_list"></ul>

            </ul>


        </div>





        <!-- /END THE FEATURETTES -->

        <hr>

        <!-- FOOTER -->
        <footer>
            <p class="foot-text">Thank you for reading</p>
        </footer>
        <!-- /END OF FOOTER -->

    </div><!-- /container -->

    <!-- JavaScript -->
    <script src="js/jquery-1.10.2.js"></script>
    <script src="js/bootstrap.js"></script>
    <script type="module" src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"></script>
    <script nomodule src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.js"></script>

    <script>



        // Function to fetch and process the .csv file
        async function fetchFixturesFile() {
            try {
                const response = await fetch('./assets/fixtures.csv');
                const data = await response.text();
                const yesterdayDate = new Date((new Date()).valueOf() - 1000 * 60 * 60 * 24);

                // Split the .csv file into individual references
                const games = data.split('\n').filter(entry => entry.trim() !== '');

                // Create a nested list of dates and times with fixtures
                const fixturesList = document.getElementById('fixtures_list');

                let currentDate = null;
                let currentDateItem = null;
                let currentTimeLists = {};

                // Create a table to display the references
                games.forEach((value, index) => {
                    if (index < 1) return;
                    const competition_kickoff_home_away = value.split(',');

                    const competition = competition_kickoff_home_away[0];
                    const kickoff = competition_kickoff_home_away[1].split(' : ');
                    var date = kickoff[0];
                    const time = kickoff[1];
                    const home = competition_kickoff_home_away[2];
                    const away = competition_kickoff_home_away[3];


                    var dateParts = date.split("/");
                    // month is 0-based, that's why we need dataParts[1] - 1
                    var dateObject = new Date(+dateParts[2], dateParts[1] - 1, +dateParts[0]);


                    console.log(dateObject, yesterdayDate);

                    // if the date is in the past, skip it
                    if (dateObject < yesterdayDate) {
                        return;
                    }

                    const weekday = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];
                    // make date the day and date
                    date = weekday[dateObject.getDay()] + ' ' + date;

                    if (date !== currentDate) {
                        currentDate = date;

                        currentDateItem = document.createElement('li');
                        currentDateItem.classList.add('date_item');
                        currentDateItem.textContent = date;

                        currentTimeLists[date] = document.createElement('ul');
                        currentTimeLists[date].classList.add('time_list');

                        currentDateItem.appendChild(currentTimeLists[date]);
                        fixturesList.appendChild(currentDateItem);
                    }

                    if (!currentTimeLists[date][time]) {
                        const currentTimeItem = document.createElement('li');
                        currentTimeItem.classList.add('time_item');
                        currentTimeItem.textContent = time;

                        const fixtureList = document.createElement('ul');
                        fixtureList.classList.add('game_list');

                        currentTimeItem.appendChild(fixtureList);
                        currentTimeLists[date][time] = fixtureList;
                        currentTimeLists[date].appendChild(currentTimeItem);
                    }

                    const fixtureItem = document.createElement('li');
                    fixtureItem.innerHTML = `<strong>${competition}</strong><br>${home} v ${away}`;
                    fixtureItem.classList.add('fixture_item');
                    fixtureItem.classList.add(competition.toLowerCase().replace(/\s/g, '-'));
                    currentTimeLists[date][time].appendChild(fixtureItem);

                });
            } catch (error) {
                console.error('Error fetching or parsing the .csv file:', error);
            }
        }

        // on page load, fetch the fixtures file
        fetchFixturesFile();

    </script>
</body>

</html>